<%-include("_header")-%>
<main class="main-content">
<!-- Seção: Sobre Nós -->
<section id="sobre" class="section-sobre py-5">
<div class="container">
<h2 class="text-center mb-4">Sobre Nós</h2>
<div class="sobre-content row align-items-center">
<div class="sobre-text col-md-7">
<h3>Nossa Missão</h3>
<p>A ONG Amor Animal é uma organização dedicada ao resgate, cuidado e proteção de animais abandonados. Trabalhamos incansavelmente para garantir que cada animal tenha uma segunda chance em um lar amoroso.</p>
<p>Nossa equipe é formada por voluntários apaixonados por animais, que dedicam seu tempo e esforço para fazer a diferença na vida de cada um deles.</p>
<p>Além do resgate e adoção, também promovemos a conscientização sobre a importância da posse responsável e do respeito aos animais.</p>
</div>
<div class="sobre-image col-md-5 text-center">
<img src="/static/css/imagem/ong2.jpg" alt="Imagem da ONG Amor Animal" class="img-fluid rounded shadow">
</div>
</div>
</div>
</section>

<!-- Seção: Notícias -->
<section id="noticias" class="section-noticias py-5 bg-light">
<div class="container">
<div class="d-flex justify-content-between align-items-center mb-4">
<h2>Notícias</h2>
<% if (user) { %>
<a href="/home/form" class="btn btn-outline-primary">Nova Noticia</a>
<%}%>
</div>
<div class="row gy-4">
<% if (typeof model1 !== 'undefined' && model1.length > 0) { %>
<%for (const home of model1) {%>
<% if (home.arquivo) { %>
<img src="/static/uploads/home/<%= home.arquivo %>" alt="<%= home.titulo %>" class="card-img-top noticia-img-fixed-height">
<% } else { %>
<img src="/static/images/placeholder-news.jpg" alt="Placeholder" class="card-img-top noticia-img-fixed-height">
<% } %>
<div class="card-body d-flex flex-column">
<h5 class="card-title"><%= home.titulo %></h5>
<p class="card-text flex-grow-1"><%= home.conteudo %></p>
<% if (home.link) { %>
<a href="<%= home.link %>" target="_blank" rel="noopener noreferrer" class="btn btn-primary mt-auto align-self-start">Leia Mais</a>
<% } else { %>
<a href="/home/<%= home.id %>" class="btn btn-primary mt-auto align-self-start">Leia Mais</a>
<% } %>

<% } %>
<% } else { %>
<div class="col-12">
<p class="text-center text-muted">Nenhuma notícia dinâmica disponível no momento.</p>
</div>
<% } %>
</div>
</div>
</div>
<div class="col-md-6 col-lg-4">
<div class="card h-100 shadow-sm noticia-item">
<div class="card-body d-flex flex-column">
<h5 class="card-title"><i class="fas fa-donate me-2 text-success"></i>Campanha de Doação</h5>
<p class="card-text flex-grow-1">Estamos arrecadando fundos para ajudar nos custos de tratamento e abrigo dos animais. Sua doação faz a diferença!</p>
<a href="/doacao" class="btn btn-success mt-auto align-self-start">Doe Agora</a>
</div>
</div>
</div>
<div class="col-md-6 col-lg-4">
<div class="card h-100 shadow-sm noticia-item">
<div class="card-body d-flex flex-column">
<h5 class="card-title"><i class="fas fa-calendar-alt me-2 text-info"></i>Evento de Adoção</h5>
<p class="card-text flex-grow-1">Participe do nosso próximo evento de adoção! Teremos muitos pets esperando por um lar. Venha conhecer e se apaixonar!</p>
<a href="/sobre" class="btn btn-info mt-auto align-self-start">Saiba Mais</a>
</div>
</div>
</div>
</div>
</div>
</section>

<!-- Seção: Adoção -->
<section id="adocao" class="section-adocao py-5">
<div class="container">
<h2 class="text-center mb-4">Adoção</h2>
<div class="adocao-intro text-center mb-4">
<h3>Adote um PET e faça a diferença na vida dele!</h3>
<p>Adotar um animal é um ato de amor e responsabilidade. Ao adotar, você não só ganha um novo amigo, mas também ajuda a salvar uma vida.</p>
<p>Na ONG Amor Animal, temos muitos pets esperando por um lar amoroso. Cada um deles tem uma história única e está pronto para dar e receber amor.</p>
</div>
<div class="photobanner-container mb-4" id="photobanner-adocao">
<div class="photobanner-slides">
<% if (typeof model2 !== 'undefined' && model2.length > 0) { %>
<% model2.forEach((adocao, index) => { %>
<div class="photobanner-slide <%= index === 0 ? 'active' : '' %>">
<a href="/adocao">
<img src="/static/uploads/adocao/<%= adocao.arquivo || 'placeholder-pet.jpg' %>" alt="Foto de <%= adocao.nome %> para adoção" class="adocao-img" />
</a>
<div class="banner-text">
<p class="adocao-nome"><%= adocao.nome %></p>
</div>
</div>
<% }) %>
<% } else { %>
<div class="photobanner-slide active">
<img src="/static/images/placeholder-pet.jpg" alt="Nenhum pet para adoção no momento" class="adocao-img placeholder-img" />

<p>Nenhum pet disponível para adoção no momento.</p>
<a href="/adocao/form" class="btn btn-sm btn-primary mt-1">Adicionar Pet</a>

</div>
<% } %>
</div>
<% if (typeof model2 !== 'undefined' && model2.length > 1) { %>
<button class="photobanner-control prev">&lt;</button>
<button class="photobanner-control next">&gt;</button>
<div class="photobanner-dots">
<% model2.forEach((adocao, index) => { %>
<span class="dot <%= index === 0 ? 'active' : '' %>" data-slide="<%= index %>"></span>
<% }) %>
</div>
<% } %>
</div>
<div class="contagem-adotantes text-center mb-5">
<%
let adotantesCountText = '0';
if (typeof model4 !== 'undefined' && model4.length > 0 && model4[0] && typeof Object.values(model4[0])[0] !== 'undefined') {
adotantesCountText = Object.values(model4[0])[0];
}
%>
<p class="contagem-adotantes-texto fs-5">
<i class="fas fa-users me-2"></i>
Já temos <span class="numero-destaque fw-bold"><%= adotantesCountText %></span> adotantes na nossa comunidade!
</p>
<a href="/adotante" class="btn btn-outline-secondary btn-sm">Ver Adotantes &gt;</a>
</div>


 <!-- Seção Historia de adotados -->
<div class="historias-adotados">
<h3 class="text-center mb-4">Histórias de Adotados</h3>
<a href="adotado/form">Adicione sua Historia.</a>
<p class="text-center mb-4">Leia as experiências de quem já adotou e inspire-se. Você também pode contar a história do seu pet!</p>
<div class="row gy-4">

<% if (typeof model6 !== 'undefined' && model6.length > 0) { %>
<% model6.forEach(adotado => { %>
<div class="col-md-6 col-lg-4">
<div class="historia-item card h-100 shadow-sm">
<img src="/static/uploads/adotado/<%= adotado.arquivo %>" alt="Foto de <%= adotado.pet %>, adotado por <%= adotado.tutor %>" class="card-img-top historia-img-fixed-height"/>
<div class="card-body d-flex flex-column">
<h5 class="card-title historia-pet">Pet: <%= adotado.pet %></h5>
<h6 class="card-subtitle mb-2 text-muted historia-tutor">Tutor: <%= adotado.tutor %></h6>
<blockquote class="historia-texto card-text flex-grow-1">"<%= adotado.historia %>"</blockquote>
<p class="historia-origem card-text mt-auto"><small class="text-muted">Origem: <%= adotado.origem %></small></p>
</div>
</div>
</div>
</div>
<% }) %>
<% } else { %>
<div class="col-12">
<div class="historia-sem-itens text-center p-4 border rounded bg-light">
<p>Nenhuma história de adoção foi adicionada ainda.</p>
<a href="/form_adotado" class="btn btn-primary">
Adicione sua História &gt;
</a>
</div>
</div>
<% } %>
</div>
<div class="text-center mt-4">
<a href="/adocao" class="btn btn-secondary">Ver Todas as Histórias &gt;</a>
</div>
</div>
</div>
</section>

<!-- Seção: Números -->
<section id="numeros" class="section-numeros bg-light py-5">
<div class="container">
<h2 class="text-center mb-5">Nossos Números</h2>
<div class="row text-center gy-4 justify-content-center">

<!-- numeros adocao -->
<div class="col-md-4">
    <div class="card h-100 shadow-sm">
    <div class="card-body d-flex flex-column align-items-center justify-content-center p-4">
    <i class="fas fa-handshake fa-3x text-success mb-3"></i>
    <h5 class="card-title">Em adoção</h5>
    <p class="card-text display-4 fw-bold">
        <% if (typeof model3 !== 'undefined' && model3.length > 0) { %>
            <%= Object.values(model3[0])[0] %>
                        
        <% } else { %>
            0
        <% } %>
    </p>  
    <a href="/adocao" class="btn btn-outline-success mt-3">Veja Todos</a>
    </div>
    </div>
    </div>

<!-- numeros adotados -->
<div class="col-md-4">
    <div class="card h-100 shadow-sm">
    <div class="card-body d-flex flex-column align-items-center justify-content-center p-4">
    <i class="fas fa-handshake fa-3x text-success mb-3"></i>
    <h5 class="card-title">Adotados</h5>
    <p class="card-text display-4 fw-bold">
        <% if (typeof model7 !== 'undefined' && model7.length > 0) { %>
            <%= Object.values(model7[0])[0] %>
                        
        <% } else { %>
            0
        <% } %>
    </p>  
    <a href="/adotado" class="btn btn-outline-success mt-3">Veja Todos</a>
    </div>
    </div>
    </div>

<!-- numeros adotantes -->
<div class="col-md-4">
    <div class="card h-100 shadow-sm">
    <div class="card-body d-flex flex-column align-items-center justify-content-center p-4">
    <i class="fas fa-handshake fa-3x text-success mb-3"></i>
    <h5 class="card-title">Adotantes</h5>
    <p class="card-text display-4 fw-bold">
        <% if (typeof model5 !== 'undefined' && model5.length > 0) { %>
            <%= Object.values(model5[0])[0] %>
                        
        <% } else { %>
            0
        <% } %>
    </p>  
    <a href="/adotante" class="btn btn-outline-success mt-3">Veja Todos</a>
    </div>
    </div>
    </div>
    
    



<!-- numeros procura_se -->
<div class="col-md-4">
    <div class="card h-100 shadow-sm">
    <div class="card-body d-flex flex-column align-items-center justify-content-center p-4">
    <i class="fas fa-handshake fa-3x text-success mb-3"></i>
    <h5 class="card-title">Pets Desaparecidos</h5>
    <p class="card-text display-4 fw-bold">
        <% if (typeof model11 !== 'undefined' && model11.length > 0) { %>
            <%= Object.values(model11[0])[0] %>
                        
        <% } else { %>
            0
        <% } %>
    </p>  
    <a href="/procura_se" class="btn btn-outline-success mt-3">Veja Todos</a>
    </div>
    </div>
    </div>
</div>

<!-- numeros parcerias-->
<div class="col-md-4">
    <div class="card h-100 shadow-sm">
    <div class="card-body d-flex flex-column align-items-center justify-content-center p-4">
    <i class="fas fa-handshake fa-3x text-success mb-3"></i>
    <h5 class="card-title">Parcerias</h5>
    <p class="card-text display-4 fw-bold">
        <% if (typeof model13 !== 'undefined' && model13.length > 0) { %>
            <%= Object.values(model13[0])[0] %>
                        
        <% } else { %>
            0
        <% } %>
    </p>  
    <a href="/parceria" class="btn btn-outline-success mt-3">Veja Todos</a>
    </div>
    </div>
    </div>

<!-- numeros castracoes -->
<div class="col-md-4">
<div class="card h-100 shadow-sm">
<div class="card-body d-flex flex-column align-items-center justify-content-center p-4">
    <i class="fas fa-cut fa-3x text-primary mb-3"></i>
    <h5 class="card-title">Castrações</h5>

    <%
    // Objeto para armazenar contagens por ano a partir de model8
    const contagemPorAno = {};
    let dadosDeCastracaoModel8Existem = false;
    let menorAnoNosDadosModel8; // Para usar como fallback para "desde" se anoOrigem não for fornecido

    if (typeof model8 !== 'undefined' && model8.length > 0) {
        dadosDeCastracaoModel8Existem = true;
        model8.forEach(castracao => {
            if (castracao.origem) {
                try {
                    const dataObj = new Date(castracao.origem);
                    if (!isNaN(dataObj.getTime())) { // Verifica se a data é válida
                        const ano = dataObj.getFullYear();
                        contagemPorAno[ano] = (contagemPorAno[ano] || 0) + 1;
                        if (menorAnoNosDadosModel8 === undefined || ano < menorAnoNosDadosModel8) {
                            menorAnoNosDadosModel8 = ano;
                        }
                    }
                } catch (e) {
                    // console.error("Formato de data inválido para castracao.origem:", castracao.origem, e);
                }
            }
        });
    }
    // Ordena os anos em ordem decrescente (mais recente primeiro)
    const anosOrdenados = Object.keys(contagemPorAno).sort((a, b) => parseInt(b) - parseInt(a));
    %>

    <% if (anosOrdenados.length > 0) { %>
        <p class="text-muted mb-2 small">Realizadas por ano </p>
        <div class="table-responsive mb-3 w-100" >
            <table class="table table-sm table-borderless text-start mx-auto" id="contagem-por-ano-table">
                <tr>
                    <th>Ano</th>
                    <th>Quantidade</th>
                </tr>
                    <% anosOrdenados.forEach(ano => { %>
                        <tr>
                            <td>2024</td>
                            <td>250</td>
                        </tr>
                        <tr>
                            <td class="fw-bold pe-2"><%= ano %></td>
                            <td><%= contagemPorAno[ano] %></td>
                        </tr>
                    <% }); %>
                </tr>
            </table>
        </div>
    <% } else if (dadosDeCastracaoModel8Existem) { %>
        <p class="text-muted">Nenhum registro de castração com data válida encontrado em model8.</p>
    <% } %>  

     <a href="/castracao" class="btn btn-outline-primary mt-3">Detalhes Castração</a>
</div>
</div>
</div>

<!-- tickets de castrcao -->
<div class="col-12 mt-5">
<div class="card shadow-sm">
<div class="card-body">
<h5 class="card-title text-center mb-3"><i class="fas fa-ticket-alt me-2"></i>Últimos Tickets de Castração</h5>
<% if (typeof model8 !== 'undefined' && model8.length > 0) { %>
<div class="table-responsive">
<table class="table table-striped table-hover table-sm caption-top">

<thead>
<tr>
<th>Ticket</th>
<th>Data</th>
<th>Nome</th>
<th>Espécie</th>
<th>Clínica</th>
</tr>
</thead>
<tbody>
<% for (const castracao of model8) { %>
<tr>
<td><%= castracao.ticket %></td>
<td><%= castracao.origem ? new Date(castracao.origem).toLocaleDateString('pt-BR') : 'N/A' %></td>
<td><%= castracao.nome %></td>
<td><%= castracao.especie %></td>
<td><%= castracao.clinica %></td>
</tr>
<% } %>
</tbody>
</table>
</div>
<div class="text-center mt-3">
<a href="/castracao" class="btn btn-secondary">Ver Todos os Tickets</a>
</div>
<% } else { %>
<p class="text-center text-muted mt-3">Nenhum ticket de castração recente para exibir.</p>
<% } %>
</div>
</div>
</div>
</div>
</div>
</section>

<!-- Seção: Procura-se -->
<section id="procura-se" class="section-procura-se py-5">
<div class="container">
<div class="d-flex justify-content-between align-items-center mb-4">
<h2>Procura-se</h2>
<a href="/procura_se" class="btn btn-outline-secondary">Ver Todos</a>
</div>
<div class="procura-se-content">
<div class="procura-se-intro text-center mb-4">
<h3>Ajude-nos a encontrar nossos amigos perdidos!</h3>
<p>Aqui você encontra os animais que estão sendo procurados por seus tutores. Se você viu algum deles, entre em contato conosco ou com o tutor!</p>
</div>
<div class="row gy-4">
<% if (typeof model10 !== 'undefined' && model10.length > 0) { %>
<% for (const procura_se of model10) { %>
    
<div class="col-md-6 col-lg-4">
<div class="procura-item card h-100 shadow-sm">
<img src="/static/uploads/procura_se/<%= procura_se.arquivo %>" alt="Foto de <%= procura_se.nome %>" class="card-img-top procura-img-fixed-height"/>
<div class="card-body d-flex flex-column">
<h5 class="card-title procura-nome">Nome: <%= procura_se.nomePet %></h5>
<p class="procura-descricao card-text flex-grow-1"><%= procura_se.caracteristicas %></p>
<p class="procura-contato card-text mt-auto"><small class="text-muted">Contato: <%= procura_se.contato %></small></p>
</div>
</div>
</div>
<% }%>
<% } else { %>
<div class="col-12">
<div class="procura-sem-itens text-center p-4 border rounded bg-light">
<p>Nenhum animal perdido foi cadastrado ainda.</p>
<a href="/procura_se/form" class="btn btn-primary">
Cadastre um Animal Perdido &gt;
</a>
</div>
</div>
<% } %>
</div>
</div>
</div>
</section>

<!-- Seção: Parcerias -->
<section id="parcerias" class="section-parcerias py-5 bg-light">
<div class="container">
<div class="d-flex justify-content-between align-items-center mb-4">
<h2>Parcerias</h2>
<a href="/parceria" class="btn btn-outline-secondary">Ver Todos</a>
</div>
<div class="parcerias-content">
<div class="parcerias-intro text-center mb-4">
<h3>Conheça nossos parceiros que apoiam nossa causa!</h3>
<p>Trabalhamos em conjunto com diversas empresas e profissionais para oferecer o melhor cuidado aos animais.</p>
</div>

<div class="row gy-4 justify-content-center">
<% if (typeof model12 !== 'undefined' && model12.length > 0) { %>
<% for (const parceria of model12) { %>
<!-- A div class="photobanner-slides" foi removida daqui -->
<div class="col-md-6 col-lg-4 col-xl-3">
<div class="parceria-item card h-100 shadow-sm">
<div class="card-body d-flex flex-column">
<h5 class="card-title parceria-nome"><%= parceria.empresa %></h5>
<p class="parceria-descricao card-text flex-grow-1"><%= parceria.proposta %></p>
<% if (parceria.link) { %>
<a href="<%= parceria.link %>" target="_blank" rel="noopener noreferrer" class="btn btn-sm btn-outline-info mt-2 align-self-start">Visite o Site</a>
<% } %>
</div>
</div>
</div>
<% }%>
<% } else { %>
<div class="col-12">
<div class="parceiros-sem-itens text-center p-4 border rounded">
<p>Nenhum parceiro cadastrado no momento.</p>
<a href="/parceria/form" class="btn btn-primary">
Cadastre um Parceiro &gt;
</a>
</div>
</div>
<% } %>
</div> <!-- Fim .row -->
</div> <!-- Fim .parcerias-content -->
</div>
</section>

</main>

<%- include("_footer") -%>
